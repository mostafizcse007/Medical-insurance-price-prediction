import pickle
import pandas as pd
import gradio as gr

with open("medical_model.pkl", "rb") as file:
    model = pickle.load(file)

def predict(age, sex, bmi, children, smoker, region):
    df = pd.DataFrame(
        [[age, sex.lower(), bmi, children, smoker.lower(), region.lower()]],
        columns=["age", "sex", "bmi", "children", "smoker", "region"]
    )
    prediction = model.predict(df)[0]
    return f"Estimated cost: {prediction:,.2f}"

with gr.Blocks() as app:#trying different types of implementation by using the documentation
    gr.Markdown(
            """
        # üè• Medical Insurance Cost Prediction
        <span style="color: gray; font-size: 15px;">
        Enter patient details to predict insurance charges using a trained ML model.
        </span>
        """
    )

    with gr.Row():
        with gr.Column(scale=1):
            gr.Markdown("### üßæ Patient Information")

            age = gr.Number(label="Age", value=28)
            sex = gr.Dropdown(["Male", "Female"], label="Sex")
            bmi = gr.Number(label="BMI", value=27.5)
            children = gr.Number(label="Number of Children", value=0)
            smoker = gr.Dropdown(["Yes", "No"], label="Smoker")
            region = gr.Dropdown(
                ["Southwest", "Southeast", "Northwest", "Northeast"],
                label="Region"
            )

            submit_btn = gr.Button("üí° Predict Charges", variant="primary")

        with gr.Column(scale=1):
            gr.Markdown("### üí∞ Prediction Result")

            output = gr.Textbox(
                label="Estimated Medical Charges",
                placeholder="Click Predict to see result",
                interactive=False
            )

            gr.Markdown(
                """
                **Note:**  
                This is an estimate generated by my first trailed ML model.
                """
            )

    submit_btn.click(
        fn=predict,
        inputs=[age, sex, bmi, children, smoker, region],
        outputs=output
    )

if __name__ == "__main__":
    app.launch(theme=gr.themes.Soft())
